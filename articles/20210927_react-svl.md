---
title: "Reactç”¨ã®ç°¡å˜ãªãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½œã‚Šã¾ã—ãŸ"
emoji: "ğŸŒŠ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["react", "validation"]
published: true
---

# ã¯ã˜ã‚ã«

React ã‚’ç”¨ã„ãŸ Web ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™ºã«ãŠã„ã¦ã€Form ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã©ã†ã™ã‚‹ã‹ã¨ã„ã†å•é¡Œã«é­é‡ã—ã¾ã—ãŸã€‚
`React Hook Form`ã‚„`Formik`ãªã©ã„ã‚ã‚“ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æ¯”è¼ƒãƒ»æ¤œè¨ã—ã¦ãã¾ã—ãŸãŒã€
ãã“ã¾ã§å¤§ããªæ©Ÿèƒ½ã¯å¿…è¦ãªãç°¡å˜ãªãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãŒã§ãã‚Œã°ã„ã„ã¨ã„ã†è€ƒãˆã‹ã‚‰ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’è‡ªä½œã—ã¾ã—ãŸã€‚

https://github.com/wattanx/react-svl

## æ¬²ã—ã‹ã£ãŸæ©Ÿèƒ½

ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æ©Ÿèƒ½ã¨ã—ã¦æ¬²ã—ã‹ã£ãŸã®ã¯

- ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ«ãƒ¼ãƒ«ã‚’æŒ‡å®šã§ãã‚‹
- Controlled Components ã‚’åˆ©ç”¨ã™ã‚‹
- å¿…é ˆãƒã‚§ãƒƒã‚¯ã€æœ€å°ãƒ»æœ€å¤§å€¤ãƒã‚§ãƒƒã‚¯ã€æœ€å¤§ãƒ»æœ€å°æ–‡å­—é•·ãƒã‚§ãƒƒã‚¯

## ä½¿ã„æ–¹

ã¾ãšã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

```
npm install react-svl
```

or

```
yarn add react-svl react
```

ã“ã“ã§ã¯ã€Chakra UI ã‚’ä½¿ã£ã¦è§£èª¬ã—ã¾ã™ã€‚

```tsx:example.tsx
import { Box } from '@chakra-ui/layout';
import { Input } from '@chakra-ui/input';
import { FormControl, FormErrorMessage, FormLabel } from '@chakra-ui/form-control';
import { useForm } from 'react-svl';

export const ValidationExample = () => {
  const { errors, values, setFieldValue, validateField } = useForm({
    initialValues: {
      FirstName: '',
      Password: '',
    },
    validationRules: {
      FirstName: {
        isRequired: true,
      },
      Password: {
        minLength: 8,
      },
    },
  });
  return (
    <Box>
      <FormControl isInvalid={errors.FirstName.isInValid}>
        <FormLabel>First Name</FormLabel>
        <Input
          value={values.FirstName}
          onChange={(e) => setFieldValue('FirstName', e.currentTarget.value)}
          onBlur={() => validateField('FirstName')}
        />
        <FormErrorMessage>{errors.FirstName.isRequired?.message}</FormErrorMessage>
      </FormControl>
      <FormControl isInvalid={errors.Password.isInValid}>
        <FormLabel>Password</FormLabel>
        <Input
          value={values.Password}
          onChange={(e) => setFieldValue('Password', e.currentTarget.value)}
          onBlur={() => validateField('Password')}
        />
        <FormErrorMessage>{errors.Password.minLength?.message}</FormErrorMessage>
      </FormControl>
    </Box>
  );
};
```

`react-svl`ã‹ã‚‰ã¯ä¸€ã¤ã® Custom Hooks ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚

`useForm`ã¯ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã«å¿…è¦ãªé–¢æ•°ã‚’æä¾›ã—ãŸã‚Šã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šã—ãŸã‚Šã™ã‚‹ Hooks ã§ã™ã€‚

## è©³ç´°

### ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ã®è¨­å®š

ã¾ãšã¯ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ã¨åˆæœŸå€¤ã‚’è¨­å®šã—ã¾ã™ã€‚

`initialValues`ã®åˆæœŸå€¤ã€`validationRules`ã«ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šã—ã¾ã™ã€‚
ã“ã‚Œã¯æ¬²ã—ã‹ã£ãŸæ©Ÿèƒ½ã®`ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ«ãƒ¼ãƒ«ã‚’æŒ‡å®šã§ãã‚‹`ã‚’æº€ãŸã™ãŸã‚ã«å®Ÿè£…ã—ã¾ã—ãŸã€‚

```tsx
const { errors, values, setFieldValue, validateField } = useForm({
  initialValues: {
    FirstName: "",
    Password: "",
  },
  validationRules: {
    FirstName: {
      isRequired: true,
    },
    Password: {
      minLength: 8,
    },
  },
});
```

ä¸‹è¨˜ã®ã‚ˆã†ãªå‹ã‚’ä½œæˆã—ã¦ã„ã‚‹ã®ã§ã€å…¥åŠ›æ™‚ã« type safe ã«è¨­å®šãŒå¯èƒ½ã§ã™ã€‚

```tsx
export type UseFormProps<T> = {
  validationRules: ValidationRule<T>;
  initialValues: T;
};

export function useForm<T extends { [key: string]: any }>({
  initialValues,
  validationRules,
}: UseFormProps<T>);
```

ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ã¨ã—ã¦è¨­å®šã§ãã‚‹ã®ã¯ä¸‹è¨˜ã®é …ç›®ã§ã™ã€‚

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ | å‹                             | èª¬æ˜                                                              |
| :--------- | :----------------------------- | :---------------------------------------------------------------- |
| isRequired | boolean                        | å¿…é ˆã‹ã©ã†ã‹                                                      |
| max        | number                         | æœ€å¤§å€¤                                                            |
| min        | number                         | æœ€å°å€¤                                                            |
| maxLength  | number                         | æœ€å¤§æ–‡å­—é•·                                                        |
| minLength  | number                         | æœ€å°æ–‡å­—é•·                                                        |
| validate   | (value: T[keyof T]) => boolean | ã‚«ã‚¹ã‚¿ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«(true: ã‚¨ãƒ©ãƒ¼ã‚ã‚Šã€false: ã‚¨ãƒ©ãƒ¼ãªã—) |

### state ã®å¤‰æ›´

`react-svl`ã¯ Controlled Components ã«ã—ãŸã‹ã£ãŸã®ã§ã€Input è¦ç´ ã« state ã‚’å®šç¾©ã—ã¦ onChange ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
`setFieldValue(ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å, ã‚»ãƒƒãƒˆã—ãŸã„å€¤)`ã‚’ä½¿ã†ã“ã¨ã§ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã®ã§ state ã®å¤‰æ›´ãŒå¯èƒ½ã§ã™ã€‚

```tsx
<Input
  value={values.FirstName}
  onChange={(e) => setFieldValue("FirstName", e.currentTarget.value)}
/>
```

### Validation ã®å®Ÿè¡Œ

`validate(ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å)`ã‚’ä½¿ã†ã“ã¨ã§ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚

```tsx
<Input
  value={values.FirstName}
  onChange={(e) => setFieldValue("FirstName", e.currentTarget.value)}
  onBlur={() => validateField("FirstName")}
/>
```

### ã‚¨ãƒ©ãƒ¼æƒ…å ±ã®å–å¾—

`errors`ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã‚¨ãƒ©ãƒ¼æƒ…å ±ãŒæ ¼ç´ã•ã‚Œã¦ã„ã¾ã™ã€‚
ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œã®çµæœã€ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Œã°`errors.ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å.isInvalid`ãŒ`true`ã‚’è¿”ã—ã¾ã™ã€‚

```tsx
<FormControl isInvalid={errors.FirstName.isInValid}>
  <FormLabel>First Name</FormLabel>
  <Input
    value={values.FirstName}
    onChange={(e) => setFieldValue("FirstName", e.currentTarget.value)}
    onBlur={() => validateField("FirstName")}
  />
  <FormErrorMessage>{errors.FirstName.isRequired?.message}</FormErrorMessage>
</FormControl>
```

ã¾ãŸä¸‹è¨˜ã®ã‚ˆã†ã«ã€å„ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ã«å¯¾å¿œã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§è¨­å®šã™ã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚(Custom Rule ã®å ´åˆã¯ãªã—)
`errors.ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å.ãƒ«ãƒ¼ãƒ«å.message`ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

| ãƒ«ãƒ¼ãƒ«     | ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸                                                          |
| :--------- | :------------------------------------------------------------------------ |
| isRequired | `{ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å}` is required.                                             |
| max        | `{ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å}` must be less than or equal to `{æœ€å¤§å€¤}`.                |
| min        | `{ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å}` must be greater than or equal to `{æœ€å°å€¤}`.             |
| maxLength  | `{ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å}` must be less than or equal to `{æœ€å¤§æ–‡å­—é•·}` characters. |
| minLength  | `{ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å}` must be `{æœ€å°æ–‡å­—é•·}` characters or more.               |

### Demo

ã“ã‚Œã¾ã§ç´¹ä»‹ã—ãŸã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿéš›ã«å‹•ã‹ã™ã¨ä¸‹è¨˜ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

@[codesandbox](https://codesandbox.io/embed/competent-bas-gv4o9?fontsize=14&hidenavigation=1&theme=dark)

## æœ€å¾Œã«

ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãªã©ã¯å…¨ãè€ƒæ…®ã§ãã¦ã„ãªã„ã®ã§ä»Šå¾Œã¯ãã®ã‚ãŸã‚Šã‚’æ”¹å–„ã—ã¦ã„ã£ãŸã‚Šã€
ä»–ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å‚è€ƒã«ã‚‚ã†å°‘ã—æ‹¡å¼µã—ã¦ã„ããŸã„ã¨æ€ã£ã¦ã„ã¾ã™ã€‚

ç°¡å˜ãªãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè£…ã®å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚

https://github.com/wattanx/react-svl

## å‚è€ƒ

æ¤œè¨ã—ãŸãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

- React Hook Form

https://react-hook-form.com/

- Formik

https://formik.org/docs/overview

- Zod

https://github.com/colinhacks/zod
